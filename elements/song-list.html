<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="song-box.html">
  
<polymer-element name="song-list">
  <core-ajax auto url="/api/v1/list.php" 
      params='{"genre":"{{genre}}"}'
      handleAs="json"></core-ajax>
   
  <template repeat="{{response}}">
    <song-box>
        <img src='/api/v1/art.php?file={{filename}}'></img>
        <div>
            <h1>{{title}}</h1>
            <core-tooltip label="{{album}}" class="fancy" role="tooltip">
                <h2>{{artist}}</h2>
            </core-tooltip>
            <h3>{{length}}</h3>
        </div>
    </song-box>
    <br />
  </template>
  
  <script>
  </script>
  <script>
    Polymer('song-list', {genre: 'all'});
    document.addEventListener('polymer-ready', function() {
      var ajax = document.querySelector("core-ajax");
      ajax.addEventListener("core-response", 
        function(e) {
          document.querySelector('template').model = {
            response: e.detail.response
          };
        }
      );
    });
  </script>
</polymer-element>
